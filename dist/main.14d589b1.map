{"version":3,"sources":["main.js"],"names":["canvas","fabric","Canvas","preserveObjectStacking","backgroundColor","Image","fromURL","oImg","insertAt","eventit","$","getObjects","each","t","e","on","target","console","log","type","bringToFront","discardActiveObject","renderAll","control_init","set","cornerSize","padding","transparentCorners","cornerStyle","cornerColor","borderColor","CornerStyle","text","Text","top","left","angle","scaleX","scaleY","download","toDataURL","obj","getActiveObject","listener","window","keypress","Listener","simple_combo","remove","bringForward","sendBackwards","text_init","index","item","val","prop","newText","length","data_url","li","append","gif","GIF","workers","quality","width","height","addFrame","delay","blob","render","src","add"],"mappings":"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","file":"main.14d589b1.map","sourceRoot":"../src","sourcesContent":["var canvas = new fabric.Canvas(\"iAvatar\", {\n  preserveObjectStacking: true\n});\ncanvas.backgroundColor = \"rgba(255,255,255,1)\";\nfabric.Image.fromURL(\"./img/avatar.png\", function(oImg) {\n  canvas.insertAt(oImg, 0);\n}); //设置外卖头盔图层的位置为最下面\n\n\n//双击图片显示粘贴\nfunction eventit() {\n  $(canvas.getObjects()).each((t, e)=>{\n    e.on(\"mousedblclick\", t=>{\n      var e = t.target\n      console.log(e.type)\n      canvas.bringToFront(e)\n      canvas.discardActiveObject()\n      canvas.renderAll()\n    })\n  })\n}\n//图片的颜色改变\nfunction control_init() {\n  var t = canvas.getObjects();\n  $(t).each((t, e)=>{\n    e.set({\n      cornerSize: 15,\n      padding: 5,\n      transparentCorners: !0,\n      cornerStyle: \"circle\",\n      cornerColor: \"#CD853F\",\n      borderColor: \"#CD853F\"\n    })\n  })\n}\n\n//设置头盔上面图片的位置信息\nfabric.Image.fromURL(\"./img/python.png\", function(oImg) {\n  canvas.insertAt(oImg, 1);\n  oImg.set(\"top\", 91);\n  oImg.set(\"left\", 98);\n  oImg.set(\"angle\", 320);\n  oImg.set(\"scaleX\", 0.3);\n  oImg.set(\"scaleY\", 0.3);\n  oImg.set({\n    cornerSize: 15,\n    padding: 5,\n    transparentCorners: true,\n    CornerStyle: \"circle\",\n    cornerColor: \"#CD853F\",\n    borderColor: \"#CD853F\"\n  });\n});\n//设置文字旋转\nvar text = new fabric.Text(\"人生苦短，我用python\", {\n  top: 182,\n  left: 145,\n  angle: 321,\n  scaleX: 0.4,\n  scaleY: 0.38\n});\ntext.set(\"fill\", \"white\");\ntext.set({\n  cornerSize: 15,\n  padding: 5,\n  transparentCorners: true,\n  CornerStyle: \"circle\",\n  cornerColor: \"#CD853F\",\n  borderColor: \"#CD853F\"\n});\ncanvas.insertAt(text, 2);\n\n$(\"#downloadPic\").on(\"click\", function() {\n  download(canvas.toDataURL(\"png\"), \"avatar.png\", \"image/png\");\n});\n\n//旋转图片  获取图片得坐标\n$(\"#debug\").on(\"click\", function() {\n  var obj = canvas.getActiveObject(); //获取选中的素材\n  console.log(\"top=\" + obj.top);\n  console.log(\"left=\" + obj.left);\n  console.log(\"angle=\" + obj.angle);\n  console.log(\"scaleX=\" + obj.scaleX);\n  console.log(\"scaleY=\" + obj.scaleY);\n});\n$(() => {\n  var listener = new window.keypress.Listener();\n\n  //点击delete按钮实现删除图片\n  listener.simple_combo(\"delete\", () => {\n    var obj = canvas.getActiveObject();\n    if (obj) {\n      canvas.remove(obj);\n    }\n  });\n  //点击[ 向左平移图片\n  listener.simple_combo(\"[\", () => {\n    var obj = canvas.getActiveObject();\n    if (obj) {\n      canvas.bringForward(obj);\n    }\n  });\n  //点击]向右平移图片\n  listener.simple_combo(\"]\", () => {\n    var obj = canvas.getActiveObject();\n    if (obj) {\n      canvas.sendBackwards(obj);\n    }\n  });\n  text_init();\n});\n\n//文字打印\nfunction text_init() {\n  $(canvas.getObjects()).each((index, item) => {\n    if (item.type == \"text\") {\n      item.on(\"selected\", () => {\n        $(\"#userText\").val(item.text);\n        $(\"#userText\").prop(\"disabled\", false);\n      });\n    }\n  });\n}\n//修改输入文本，改变头像文字:输入框增加onchange事件\n$(\"#userText\").on(\"change\", function() {\n  var newText = $(\"#userText\").val();\n  console.log(newText);\n  if (newText.length > 0) {\n    var obj = canvas.getActiveObject();\n    if (obj && obj.type == \"text\") {\n      obj.set(\"text\", newText);\n      canvas.renderAll();\n    }\n  }\n});\n\n$(\"#pic_add\").on(\"click\", function() {\n  var data_url = canvas.toDataURL(\"png\");\n  var li = $(\"<li><img  src='\" + data_url + \"'></li>\");\n  $(\".image-list\").append(li);\n});\n$(\"#pic_build\").on(\"click\", function() {\n  var gif = new GIF({\n    workers: 2,\n    quality: 10,\n    width: 460,\n    height: 460\n  });\n  $(\".image-list li img\").each((index, item) => {\n    gif.addFrame(item, { delay: 1000 });\n  });\n\n  gif.on(\"finished\", function(blob) {\n    download(blob), \"avatar.gif\", \"image/gif\";\n  });\n  gif.render();\n});\n\n//双击图片加入头像制作区\n$(function(){\n  $(\".image-list\").on(\"dblclick\", \"li\",\n      function () {\n        $(this).remove()\n      }),\n  $(\".bg-list>li img\").on(\"dblclick\", function(){\n    fabric.Image.fromURL( this.src, function(t){\n      canvas.add(t)\n      eventit()\n      control_init()\n    })\n  })    \n//  clipboard_init()\n  //key_init()\n})\n"]}