{"version":3,"sources":["main.js"],"names":["canvas","fabric","Canvas","eventit","getObjects","each","t","e","on","target","log","type","bringToFront","discardActiveObject","renderAll","control_init","set","backgroundColor","Image","fromURL","oImg","insertAt","text","Text","text_init","index","item","val","prop","$","toDataURL","obj","getActiveObject","top","left","angle","scaleX","scaleY","listener","window","keypress","Listener","simple_combo","remove","bringForward","sendBackwards","newText","length","data_url","li","append","gif","GIF","addFrame","delay","blob","render","src","add"],"mappings":"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","file":"main.f1d033b8.map","sourceRoot":"../src","sourcesContent":["var canvas = new fabric.Canvas(\"iAvatar\", {\n  preserveObjectStacking: true\n});\ncanvas.backgroundColor = \"rgba(255,255,255,1)\";\nfabric.Image.fromURL(\"./img/avatar.png\", function(oImg) {\n  canvas.insertAt(oImg, 0);\n}); //设置外卖头盔图层的位置为最下面\n\n\n//双击图片显示粘贴\nfunction eventit() {\n  $(canvas.getObjects()).each((t, e)=>{\n    e.on(\"mousedblclick\", t=>{\n      var e = t.target\n      console.log(e.type)\n      canvas.bringToFront(e)\n      canvas.discardActiveObject()\n      canvas.renderAll()\n    })\n  })\n}\n//图片的颜色改变\nfunction control_init() {\n  var t = canvas.getObjects();\n  $(t).each((t, e)=>{\n    e.set({\n      cornerSize: 15,\n      padding: 5,\n      transparentCorners: !0,\n      cornerStyle: \"circle\",\n      cornerColor: \"#CD853F\",\n      borderColor: \"#CD853F\"\n    })\n  })\n}\n\n//设置头盔上面图片的位置信息\nfabric.Image.fromURL(\"./img/python.png\", function(oImg) {\n  canvas.insertAt(oImg, 1);\n  oImg.set(\"top\", 91);\n  oImg.set(\"left\", 98);\n  oImg.set(\"angle\", 320);\n  oImg.set(\"scaleX\", 0.3);\n  oImg.set(\"scaleY\", 0.3);\n  oImg.set({\n    cornerSize: 15,\n    padding: 5,\n    transparentCorners: true,\n    CornerStyle: \"circle\",\n    cornerColor: \"#CD853F\",\n    borderColor: \"#CD853F\"\n  });\n});\n//设置文字旋转\nvar text = new fabric.Text(\"人生苦短，我用python\", {\n  top: 182,\n  left: 145,\n  angle: 321,\n  scaleX: 0.4,\n  scaleY: 0.38\n});\ntext.set(\"fill\", \"white\");\ntext.set({\n  cornerSize: 15,\n  padding: 5,\n  transparentCorners: true,\n  CornerStyle: \"circle\",\n  cornerColor: \"#CD853F\",\n  borderColor: \"#CD853F\"\n});\ncanvas.insertAt(text, 2);\n\n$(\"#downloadPic\").on(\"click\", function() {\n  download(canvas.toDataURL(\"png\"), \"avatar.png\", \"image/png\");\n});\n\n//旋转图片  获取图片得坐标\n$(\"#debug\").on(\"click\", function() {\n  var obj = canvas.getActiveObject(); //获取选中的素材\n  console.log(\"top=\" + obj.top);\n  console.log(\"left=\" + obj.left);\n  console.log(\"angle=\" + obj.angle);\n  console.log(\"scaleX=\" + obj.scaleX);\n  console.log(\"scaleY=\" + obj.scaleY);\n});\n$(() => {\n  var listener = new window.keypress.Listener();\n\n  //点击delete按钮实现删除图片\n  listener.simple_combo(\"delete\", () => {\n    var obj = canvas.getActiveObject();\n    if (obj) {\n      canvas.remove(obj);\n    }\n  });\n  //点击[ 向左平移图片\n  listener.simple_combo(\"[\", () => {\n    var obj = canvas.getActiveObject();\n    if (obj) {\n      canvas.bringForward(obj);\n    }\n  });\n  //点击]向右平移图片\n  listener.simple_combo(\"]\", () => {\n    var obj = canvas.getActiveObject();\n    if (obj) {\n      canvas.sendBackwards(obj);\n    }\n  });\n  text_init();\n});\n\n//文字打印\nfunction text_init() {\n  $(canvas.getObjects()).each((index, item) => {\n    if (item.type == \"text\") {\n      item.on(\"selected\", () => {\n        $(\"#userText\").val(item.text);\n        $(\"#userText\").prop(\"disabled\", false);\n      });\n    }\n  });\n}\n//修改输入文本，改变头像文字:输入框增加onchange事件\n$(\"#userText\").on(\"change\", function() {\n  var newText = $(\"#userText\").val();\n  console.log(newText);\n  if (newText.length > 0) {\n    var obj = canvas.getActiveObject();\n    if (obj && obj.type == \"text\") {\n      obj.set(\"text\", newText);\n      canvas.renderAll();\n    }\n  }\n});\n\n$(\"#pic_add\").on(\"click\", function() {\n  var data_url = canvas.toDataURL(\"png\");\n  var li = $(\"<li><img  src='\" + data_url + \"'></li>\");\n  $(\".image-list\").append(li);\n});\n$(\"#pic_build\").on(\"click\", function() {\n  var gif = new GIF({\n    workers: 2,\n    quality: 10,\n    width: 460,\n    height: 460\n  });\n  $(\".image-list li img\").each((index, item) => {\n    gif.addFrame(item, { delay: 1000 });\n  });\n\n  gif.on(\"finished\", function(blob) {\n    download(blob), \"avatar.gif\", \"image/gif\";\n  });\n  gif.render();\n});\n\n//双击图片加入头像制作区\n$(function(){\n  $(\".image-list\").on(\"dblclick\", \"li\",\n      function () {\n        $(this).remove()\n      }),\n  $(\".bg-list>li img\").on(\"dblclick\", function(){\n    fabric.Image.fromURL( this.src, function(t){\n      canvas.add(t)\n      eventit()\n      control_init()\n    })\n  })    \n//  clipboard_init()\n  //key_init()\n})\n"]}